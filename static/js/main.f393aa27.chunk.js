(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,a){e.exports=a(52)},40:function(e,t,a){},48:function(e,t,a){},52:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(28),s=a.n(o),i=(a(40),a(8)),c=a(9),l=a(11),u=a(10),m=a(12),p=a(2),v=a.n(p),d=a(4),h=a(7),f=function(){var e=Object(d.a)(v.a.mark(function e(t){var a,r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://bottd-movie-tracker.herokuapp.com/api/users/new",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});case 3:return a=e.sent,e.next=6,a.json();case 6:return r=e.sent,e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),new Error;case 13:case"end":return e.stop()}},e,this,[[0,10]])}));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(d.a)(v.a.mark(function e(t,a,r){var n,o;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://bottd-movie-tracker.herokuapp.com/api/users/favorites/new",{method:"POST",body:JSON.stringify({movie_id:t,user_id:a,title:r.title,poster_path:r.poster_path,release_date:r.release_date,vote_average:r.vote_average,overview:r.overview}),headers:{"Content-Type":"application/json"}});case 2:return n=e.sent,e.next=5,n.json();case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}},e,this)}));return function(t,a,r){return e.apply(this,arguments)}}(),b=function(){var e=Object(d.a)(v.a.mark(function e(t){var a,r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://bottd-movie-tracker.herokuapp.com/api/users/".concat(t,"/favorites"));case 2:return a=e.sent,e.next=5,a.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(d.a)(v.a.mark(function e(t,a){var r,n;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://bottd-movie-tracker.herokuapp.com/api/users/".concat(t,"/favorites/").concat(a),{method:"DELETE",body:JSON.stringify({user_id:t,movie_id:a}),headers:{"Content-Type":"application/json"}});case 2:return r=e.sent,e.next=5,r.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),w=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).toggleFavorite=Object(d.a)(v.a.mark(function t(){var a,r,n,o;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.props,r=a.user_id,n=a.movie,o=n.id,n.movie_id&&(o=n.movie_id),!e.state.favorite){t.next=9;break}return t.next=6,E(r,o);case 6:e.props.reRender(),t.next=11;break;case 9:return t.next=11,g(n.id,r,n);case 11:e.setState({favorite:!e.state.favorite});case 12:case"end":return t.stop()}},t,this)})),e.state={favorite:!1},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(d.a)(v.a.mark(function e(){var t,a=this;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(this.props.user_id);case 2:t=e.sent,t.data.find(function(e){return e.movie_id===a.props.movie.movie_id||e.movie_id===a.props.movie.id})?this.setState({favorite:!0}):this.setState({favorite:!1});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.movie;return n.a.createElement("article",{className:"movie-card",style:{backgroundImage:"url(".concat(e.poster_path,")")}},n.a.createElement("div",{className:"star-container"}),n.a.createElement("i",{onClick:this.toggleFavorite,className:"fas fa-star ".concat(this.state.favorite&&"favorite")}),n.a.createElement("div",{className:"dark-background"}),n.a.createElement("div",{className:"movie-title-container"},n.a.createElement("h2",{className:"movie-title"},e.title),n.a.createElement("p",{className:"release-date-label"},"Released:"),n.a.createElement("p",{className:"movie-release-date"},e.release_date),n.a.createElement("p",{className:"rating-label"},"Avg. Rating:"),n.a.createElement("p",{className:"movie-rating"},e.vote_average)),n.a.createElement("p",{className:"overview"},e.overview))}}]),t}(r.Component),x=Object(h.b)(function(e){return{user_id:e.user.id}})(w),O=a(33),j=function(e){return{type:"LOAD_MOVIES",movies:e}},N=function(e){return{type:"SIGN_IN",user:e}},k=function(e){return{type:"IS_LOADING",bool:e}},y=function(e){return{type:"IS_ERROR",bool:e}},S=function(){return n.a.createElement("div",null,n.a.createElement("div",{className:"loading-container"},n.a.createElement("div",{className:"lds-ripple"},n.a.createElement("div",null),n.a.createElement("div",null))),n.a.createElement("p",{className:"loading"},"Loading"))},_=a(53),C=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).componentDidMount=Object(d.a)(v.a.mark(function t(){var a;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.props.loadMovies("https://api.themoviedb.org/3/movie/popular?api_key=da90047b6c1d3526d4b04666a1b64a0d&language=en-US&page=1&region=US");case 2:return t.next=4,b(e.props.user_id);case 4:a=t.sent,e.setState({favoriteMovies:a.data});case 6:case"end":return t.stop()}},t,this)})),e.state={favorites:"",favoriteMovies:[]},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleFavorites",value:function(){var e=Object(d.a)(v.a.mark(function e(){var t,a;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="",e.next=3,b(this.props.user_id);case 3:a=e.sent,this.state.favorites||(t="favorites"),this.setState({favorites:t,favoriteMovies:a.data});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props,a=t.movies,r=t.signOut,o=t.isLoading,s=t.user,i=a;if(this.state.favorites){i=this.state.favoriteMovies;var c="Favorites",l="trending"}else c="Trending",l="favorites";return o?n.a.createElement(S,null):n.a.createElement("section",{className:"movies-section-container"},n.a.createElement("header",{className:"movies-header"},n.a.createElement("h1",{className:"movie-tracker"},"movie",n.a.createElement("img",{src:"./images/movie_roll.svg",alt:"movie roll",className:"main-logo"}),"tracker"),n.a.createElement("p",{className:"user-greeting"},"Hello, ",s.name),n.a.createElement(_.a,{to:"/login"},n.a.createElement("button",{className:"sign-out-btn",onClick:r},"sign out")),n.a.createElement(_.a,{to:"/".concat(l)},n.a.createElement("button",{className:"toggle-favorites-btn",onClick:function(){return e.toggleFavorites()}},l))),n.a.createElement("h2",{className:"movie-container-label"},c),n.a.createElement("div",{className:"movie-container-underline"}),n.a.createElement("div",{className:"movies-container"},i.map(function(t){return n.a.createElement(x,{movie:t,key:Object(O.a)(t),reRender:e.componentDidMount})}),0===i.length&&n.a.createElement("h2",{className:"no-favorites"},"You Have No Favorites")))}}]),t}(r.Component),U=Object(h.b)(function(e){return{movies:e.movies,user_id:e.user.id,isLoading:e.isLoading,user:e.user}},function(e){return{loadMovies:function(t){return e(function(e){return function(){var t=Object(d.a)(v.a.mark(function t(a){var r,n;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a(k(!0)),t.next=4,fetch(e);case 4:return r=t.sent,t.next=7,r.json();case 7:n=t.sent,a(j(n)),a(k(!1)),t.next=16;break;case 12:return t.prev=12,t.t0=t.catch(0),a(y(!0)),t.abrupt("return","Error: something went wrong");case 16:case"end":return t.stop()}},t,this,[[0,12]])}));return function(e){return t.apply(this,arguments)}}()}(t))},signOut:function(){return e({type:"SIGN_OUT"})}}})(C),M=(a(48),a(57)),I=a(54),L=a(56),R=a(58),T=a(16),D=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).handleChange=function(t){var a=t.target,r=a.value,n=a.name;e.setState(Object(T.a)({},n,r))},e.handleSubmit=function(){var t=Object(d.a)(v.a.mark(function t(a){var r,n,o;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),r=e.state,n=r.email,o=r.password,t.next=4,e.props.loginUser({email:n,password:o});case 4:void 0!==t.sent?e.setState({incorrectLogin:!0}):e.setState({validUser:!0});case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),e.state={email:"",password:"",validUser:!1,incorrectLogin:!1},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){if(this.state.validUser)return n.a.createElement(L.a,{to:"/"});var e=this.state,t=e.email,a=e.password,r=e.incorrectLogin;return n.a.createElement("div",null,n.a.createElement("h1",{className:"form-title"},"movie",n.a.createElement("img",{src:"./images/movie_roll.svg",alt:"movie roll",className:"form-logo"}),"tracker"),n.a.createElement("h2",{className:"login-title"},"Login"),n.a.createElement("form",{className:"login-form",onSubmit:this.handleSubmit},n.a.createElement("input",{className:"form-input email",type:"text",placeholder:"email",value:t,name:"email",onChange:this.handleChange}),n.a.createElement("input",{className:"form-input password",type:"password",placeholder:"password",value:a,name:"password",onChange:this.handleChange}),n.a.createElement("button",null,"Login")),n.a.createElement("div",{className:"new-account-container"},n.a.createElement("h3",{className:"incorrect-login ".concat(r&&"incorrect")},"username or password is incorrect"),n.a.createElement("h3",null,"Don't have an account?"),n.a.createElement(_.a,{className:"form-link",to:"/signup"},"Create New Account")))}}]),t}(r.Component),P=Object(h.b)(null,function(e){return{loginUser:function(t){return e(function(e){return function(){var t=Object(d.a)(v.a.mark(function t(a){var r,n;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://bottd-movie-tracker.herokuapp.com/api/users/",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});case 3:return r=t.sent,t.next=6,r.json();case 6:n=t.sent,a(N(n.data)),t.next=13;break;case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",new Error("Error: something went wrong"));case 13:case"end":return t.stop()}},t,this,[[0,10]])}));return function(e){return t.apply(this,arguments)}}()}(t))}}})(D),z=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).emailValidation=function(e){var t=new RegExp(/^(?:[a-z0-9!#$%&amp;'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&amp;'*+\/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/);return!!e.match(t)},e.handleChange=function(){var t=Object(d.a)(v.a.mark(function t(a){var r,n,o;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.target,n=r.name,o=r.value,t.next=3,e.setState(Object(T.a)({},n,o));case 3:e.checkFormCompletion();case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),e.handleSubmit=function(){var t=Object(d.a)(v.a.mark(function t(a){var r,n,o,s,i,c;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),r=e.state,n=r.name,o=r.email,s=r.password,i=r.confirmPassword,c=o,e.emailValidation(c)){t.next=6;break}return e.setState({validEmail:!1,duplicateUser:!1,passwordsMatch:!0}),t.abrupt("return");case 6:if(s===i){t.next=9;break}return e.setState({duplicateUser:!1,passwordsMatch:!1,validEmail:!0}),t.abrupt("return");case 9:return t.next=11,f({name:n,email:o,password:s});case 11:t.sent.error?e.setState({duplicateUser:!0,passwordsMatch:!0,validEmail:!0}):e.setState({validUser:!0});case 13:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),e.state={name:"",email:"",password:"",confirmPassword:"",duplicateUser:!1,validUser:!1,formComplete:!1,passwordsMatch:!0,validEmail:!0},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"checkFormCompletion",value:function(){var e=this.state,t=e.name,a=e.email,r=e.password,n=e.confirmPassword;this.setState({formComplete:""!==t&&""!==a&&""!==r&&""!==n})}},{key:"render",value:function(){var e=this.state,t=e.name,a=e.email,r=e.password,o=e.confirmPassword,s=e.validUser,i=e.formComplete,c=e.duplicateUser,l=e.passwordsMatch,u=e.validEmail;return s?n.a.createElement(L.a,{to:"/login"}):n.a.createElement("div",{className:"sign-up-container"},n.a.createElement("h1",{className:"form-title"},"movie",n.a.createElement("img",{src:"./images/movie_roll.svg",alt:"movie roll",className:"form-logo"}),"tracker"),n.a.createElement("h2",{className:"login-title"},"Sign Up"),n.a.createElement("form",{className:"login-form create-new-user-form",onSubmit:this.handleSubmit},n.a.createElement("input",{onChange:this.handleChange,type:"text",placeholder:"name",name:"name",value:t}),n.a.createElement("input",{onChange:this.handleChange,type:"text",placeholder:"email",name:"email",value:a}),n.a.createElement("input",{onChange:this.handleChange,type:"password",placeholder:"password",name:"password",value:r}),n.a.createElement("input",{onChange:this.handleChange,type:"password",placeholder:"confirm password",name:"confirmPassword",value:o}),n.a.createElement("button",{disabled:!i},"Submit"),n.a.createElement(_.a,{className:"form-link",to:"/login"},"Return to login")),n.a.createElement("h3",{className:"duplicate-user-message ".concat(c&&"create-user-error")},"An account already exists with that email"),n.a.createElement("h3",{className:"passwords-message ".concat(!l&&"create-user-error")},"Passwords must match"),n.a.createElement("h3",{className:"passwords-message ".concat(!u&&"create-user-error")},"Please enter a valid e-mail"))}}]),t}(r.Component),A=Object(h.b)(null,function(e){return{returnToSite:function(){return e(y(!1))}}})(function(e){var t=e.returnToSite;return n.a.createElement("div",{className:"error-page-container"},n.a.createElement("h1",null,"OOPS!"),n.a.createElement("h2",null,"An unexpected error occurred..."),n.a.createElement("button",{className:"return-to-site-btn",onClick:function(){return t()}},"Return to Site"))}),F=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).call(this))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user;return e.error?n.a.createElement(A,null):n.a.createElement("div",{className:"App"},n.a.createElement(M.a,null,n.a.createElement(I.a,{exact:!0,path:"/",render:function(){return t.name?n.a.createElement(L.a,{to:"/trending"}):n.a.createElement(L.a,{to:"/login"})}}),n.a.createElement(I.a,{path:"/login",component:P}),n.a.createElement(I.a,{path:"/signup",component:z}),n.a.createElement(I.a,{path:"/favorites",render:function(){return t.name?n.a.createElement(U,null):n.a.createElement(L.a,{to:"/login"})}}),n.a.createElement(I.a,{path:"/trending",render:function(){return t.name?n.a.createElement(U,null):n.a.createElement(L.a,{to:"/login"})}}),n.a.createElement(I.a,{path:"/error",component:A})))}}]),t}(r.Component),G=Object(R.a)(Object(h.b)(function(e){return{movies:e.movies,user:e.user,error:e.error}})(F));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var J=a(55),V=a(13),$=a(31),W=a(23),B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_MOVIES":var a=t.movies.results.map(function(e){return{id:e.id,title:e.title,release_date:e.release_date,vote_average:e.vote_average,poster_path:"https://image.tmdb.org/t/p/w500///"+e.poster_path,overview:e.overview}});return[].concat(Object(W.a)(e),Object(W.a)(a));default:return e}},H={name:null},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGN_IN":return t.user;case"SIGN_OUT":return{};default:return e}},q=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IS_LOADING":return t.bool;default:return e}},K=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IS_ERROR":return t.bool;default:return e}},Q=Object(V.combineReducers)({movies:B,user:Y,isLoading:q,error:K}),X=a(32),Z=Object(V.createStore)(Q,Object($.composeWithDevTools)(Object(V.applyMiddleware)(X.a)));s.a.render(n.a.createElement(h.a,{store:Z},n.a.createElement(J.a,null,n.a.createElement(I.a,{path:"/",component:G}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[35,2,1]]]);
//# sourceMappingURL=main.f393aa27.chunk.js.map